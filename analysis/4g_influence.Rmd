---
title: "4G і виборці. Як покриття LTE вплинуло на склад українського парламенту"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_data_package, echo=FALSE, message=FALSE}
suppressPackageStartupMessages({
  require(ggplot2)
  require(hrbrthemes)
  require(dplyr)
})

setwd("~/ukrainian_elections/")

poly_dil <- readr::read_rds("data/poly_dil.rds")
coord_dil <- readr::read_csv("data/cordynaty_VD.csv", col_types = readr::cols())
internet <- fst::read_fst("data/4g_internet_by_vd.fst")
parlament_election_2019_by_vd <- fst::read_fst("data/parlament_election_2019_by_vd.fst")
```

Про вплив інтернет-технологій на виборах цього року не говорив тільки лінивий експерт.

Діджитал-кампанія Володимира Зеленського, армія прихильників Петра Порошенка у Фейсбуці, блоги Анатолія Шарія та Дмитра Гордона на Ютубі - це все точно впливало на кампанії, що навіть старожили української політики, на зразок Юлії Тимошенко, почали все активніше освоювати такі майданчики як Ютуб та Інстаграм.

При цьому Україна ще точно не є на 100% інтернетизованою країною, хоч частка користувачів мережі постійно зростає. Останні роки цьому сприяє поява та розширення стандартів мобільного інтрнету 3G та 4G (LTE). Останній стандарт зв'язку для нас особливо цікавий, адже саме він дозволяє без проблем їдучи в маршрутці на роботу подивися свіжий блог Шарія, чи смакуючи шаурмою біля зупинки - новий сторіс Володимира Зеленського.

## 4G зв'язок в Україні

4G покриття в Україні забезпечують 3 основні телеком оператори - Київстар, Водафон та Лайфсел. На їх офіційних сайтах можна знайти інформацію про покриття, що я і зробив. Поті ці дані було використано для того, аби зв'ясувати, наскільки межі кожної дільниці в Україні є покриті 4G-зв'язком. Технічні деталі можна знайти в [репозиторії](https://github.com/RomanKyrychenko/ukrainian_elections).

На карті можна побачити, яка ситуація з покриттям на усіх дільницях.
```{r map, echo=FALSE}
ggplot(poly_dil %>% left_join(internet, by = "group"), 
       aes(V1, V2, group=group, fill = has_net)) +
  geom_polygon() +
  scale_fill_gradient(
    low = "#fff7ec", high = "#7f0000", #mid = "white",
    guide = guide_legend(
      nrow = 3,
      label.position = "left",
      title.position = "top",
      title = "Покриття меж виборчих дільниць мобільним інтернетом 4G"
    ),
    breaks = c(0, 0.5, 1, 2, 3),
    labels = c("Немає навіть часткового покриття", 
               "Є часткове покриття одним оператором", 
               "Є повне покриття одним оператором", 
               "Є повне покриття двома операторами", 
               "Є повне покриття трьома операторами")
  ) +
  labs(
    title = "Ступінь покритості 4G",
    caption = "На основі даних сайтів kyivstar, vodafone, lifecell"
  ) +
  theme_ipsum(base_family = "PT Sans") +
  theme(
    panel.grid = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    legend.position = "bottom"
  ) +
  coord_map("gilbert", xlim = c(22, 42), ylim = c(44, 52.4))
```

В зоні хорошого покриття 4G живе майже половина проголосувавших на виборах (близько 48% або майже 7 млн виборців). Там, де нема навіть натяку на 4G живе близько 11% виборців (або майже 1.6 млн). Інші виборці проживають у межах дільниць, де покриття тільки часткове і надається не всіма операторами. Схоже, що вплив інтрнету на виборців уже має бути дуже відчутним, так як ми при цьому не можемо врахувати вплив провідного інтернету (відсутні настільки деталізовані дані).

## Як би голосували

Отже, наявність 4G дійсно пов'язана з прихильністю до певних політичних сил.

```{r table, echo=FALSE}
suppressPackageStartupMessages(require(gt))

parlament_election_2019_by_vd %>% 
  left_join(internet, by = c("№ ВД" = "dil"))  %>% 
  mutate(
    `Покриття 4G` = case_when(
      has_net == 0 ~ "Немає навіть часткового покриття",
      has_net > 0 & has_net < 1 ~ "Є часткове покриття одним оператором",
      has_net >= 1 & has_net < 2 ~ "Є повне покриття одним оператором",
      has_net >= 2 & has_net < 3 ~ "Є повне покриття двома операторами",
      has_net == 3 ~ "Є повне покриття трьома операторами"
    )
  ) %>% group_by(`Покриття 4G`) %>% 
  summarise(
  Голос = sum(`Політична Партія "ГОЛОС"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Партія Шарія` = sum(`ПОЛІТИЧНА ПАРТІЯ "ПАРТІЯ ШАРІЯ"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  Батьківщина = sum(`політична партія Всеукраїнське об’єднання "Батьківщина"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Європейська Солідарність` = sum(`Політична партія "Європейська Солідарність"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `ОП - За Життя` = sum(`Політична партія "ОПОЗИЦІЙНА ПЛАТФОРМА – ЗА ЖИТТЯ"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Слуга народу` = sum(`ПОЛІТИЧНА ПАРТІЯ "СЛУГА НАРОДУ"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Опозиційний блок` = sum(`Політична партія "ОПОЗИЦІЙНИЙ БЛОК"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Українська стратегія` = sum(`ПОЛІТИЧНА ПАРТІЯ "УКРАЇНСЬКА СТРАТЕГІЯ ГРОЙСМАНА"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  Свобода = sum(`політична партія Всеукраїнське об’єднання "Свобода"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Радикальна партія` = sum(`ПОЛІТИЧНА ПАРТІЯ "РАДИКАЛЬНА ПАРТІЯ ОЛЕГА ЛЯШКА"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`),
  `Сила і честь` = sum(`ПОЛІТИЧНА ПАРТІЯ "СИЛА І ЧЕСТЬ"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`)
) %>% tidyr::gather(key = "Партія", "% підтримки", -`Покриття 4G`) %>% 
  tidyr::spread(`Покриття 4G`, `% підтримки`) %>% 
  arrange(desc(`Є повне покриття трьома операторами`)) %>% 
  select(Партія, `Є повне покриття трьома операторами`, 
               `Є повне покриття двома операторами`, 
               `Є повне покриття одним оператором`,
               `Є часткове покриття одним оператором`,
               `Немає навіть часткового покриття`) %>% gt() %>%
  fmt_percent(
    columns = vars(`Є повне покриття трьома операторами`, 
                   `Є повне покриття двома операторами`, 
                   `Є повне покриття одним оператором`,
                   `Є часткове покриття одним оператором`,
                   `Немає навіть часткового покриття`),
    decimals = 2,
    drop_trailing_zeros = TRUE
  ) %>% 
  text_transform(
    locations = cells_data(vars(Партія)),
    fn = function(x) {
        list(web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/%D0%97%D0%B5%21_%D0%BF%D0%B0%D1%80%D1%82%D1%96%D1%8F_%C2%AB%D0%A1%D0%BB%D1%83%D0%B3%D0%B0_%D0%9D%D0%B0%D1%80%D0%BE%D0%B4%D1%83%C2%BB.svg/1200px-%D0%97%D0%B5%21_%D0%BF%D0%B0%D1%80%D1%82%D1%96%D1%8F_%C2%AB%D0%A1%D0%BB%D1%83%D0%B3%D0%B0_%D0%9D%D0%B0%D1%80%D0%BE%D0%B4%D1%83%C2%BB.svg.png",
          height = 30
        ), 
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/5/5a/Logo_of_%22Opposition_Platform_-_For_life%22.png",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/thumb/8/87/European_Solidarity.svg/2880px-European_Solidarity.svg.png",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/2/25/Holos.png",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/a/a1/%D0%92%D0%9E_%C2%AB%D0%91%D0%B0%D1%82%D1%8C%D0%BA%D1%96%D0%B2%D1%89%D0%B8%D0%BD%D0%B0%C2%BB.png",
          height = 30
        ),
        web_image(
          url = "https://file.liga.net/images/general/2019/07/18/20190718084728-9963.jpg",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/6/6b/Opposition_Bloc_2019.png",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/%D0%9B%D0%BE%D0%B3%D0%BE%D1%82%D0%B8%D0%BF_%D0%BF%D0%B0%D1%80%D1%82%D0%B8%D0%B8_%D0%A8%D0%B0%D1%80%D0%B8%D1%8F.svg/1920px-%D0%9B%D0%BE%D0%B3%D0%BE%D1%82%D0%B8%D0%BF_%D0%BF%D0%B0%D1%80%D1%82%D0%B8%D0%B8_%D0%A8%D0%B0%D1%80%D0%B8%D1%8F.svg.png",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/uk/c/c1/%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D1%81%D1%8C%D0%BA%D0%B0_%D0%A1%D1%82%D1%80%D0%B0%D1%82%D0%B5%D0%B3%D1%96%D1%8F_%D0%93%D1%80%D0%BE%D0%B9%D1%81%D0%BC%D0%B0%D0%BD%D0%B0.jpg",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/9/98/%D0%9B%D0%BE%D0%B3%D0%BE%D1%82%D0%B8%D0%BF_%D0%92%D1%81%D0%B5%D1%83%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE_%D0%BE%D0%B1%27%D1%94%D0%B4%D0%BD%D0%B0%D0%BD%D0%BD%D1%8F_%C2%AB%D0%A1%D0%B2%D0%BE%D0%B1%D0%BE%D0%B4%D0%B0%C2%BB.png",
          height = 30
        ),
        web_image(
          url = "https://upload.wikimedia.org/wikipedia/commons/1/1d/Radical_Party_of_Oleh_Lyashko_logo.png",
          height = 30
        )
        )
    }
  ) %>% 
  data_color(
    columns = vars(`Є повне покриття трьома операторами`, 
                   `Є повне покриття двома операторами`, 
                   `Є повне покриття одним оператором`,
                   `Є часткове покриття одним оператором`,
                   `Немає навіть часткового покриття`),
    colors = scales::col_numeric(
      palette = c(
        "#ffffcc", "#800026"),
      domain = c(0, 0.5))
  ) %>% 
  tab_header(
    title = md("Як якість покриття 4G пов'язана з голосуванням на парламентських виборах?"),
    subtitle = md("Розподіли голосів виборців в залежності від покриття меж їх дільниці 4G")
  ) %>% 
  tab_style(
    style = cells_styles(bkgd_color = "white"), locations = cells_data(
      columns = vars(Партія))) %>%
  tab_source_note(
    source_note = "За даними сайту ЦВК (без врахування спецдільниць)"
  )
```

Так, фактор 4G суттєво не змінює підтримку Слуги народу та ОПЗЖ, однак є дуже відчутним для Європейської солідарності та Голосу, підтримка яких зосереджена переважно на тих дільницях, де є хороше 4G покриття. У той же час такі партії як Батьківщина та особливо Радикальна партія отримали основну підтримку на дільницях з гіршим покриттям мобільного інтернету останнього покоління. Наприклад, радикали мають на дільницях без 4G більше 8% підтримки та 4 рейтингову сходинку.

Цікавим також є кейс партії Шарія, яка в сукупності дільниць з повним покриттям 4G інтернетом 3-ма операторами має майже в 4 рази більшу підтримку, ніж на дільницях, де покриття нема взагалі.

Таким чином, доступ до інтернету є одним із факторів, який впливає на вибори, хоча не потрібно його перебільшувати. З 5 прохідних партій тільки Голос не мав достатньої підтримки серед виборців, які прописані в межах дільниць без 4G інтернету, для проходу в парламент. Чисті інтернет-проекти поки існує 5% прохідний бар'єр і поки якість покриття зв'язком не є ідеальною не претендують на прохід в парламент.


