---
title: "Ті, хто встояв перед зеленим цунамі: топ-10 мажоритарників, які виграли в округах з великою підтримкою Слуги народу"
output:
  md_document:
    variant: gfm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_data_package, echo=FALSE, message=FALSE}
suppressPackageStartupMessages({
  require(ggplot2)
  require(hrbrthemes)
  require(dplyr)
  require(gt)
})

setwd("~/ukrainian_elections/")

ovk <- sf::read_sf("data/ovk/OVK.shp")
coord_dil <- readr::read_csv("data/cordynaty_VD.csv", col_types = readr::cols())
parlament_election_2019_major_info <- fst::read_fst("data/parlament_election_2019_major_info.fst")
parlament_election_2019_by_vd_major <- fst::read_fst("data/parlament_election_2019_by_vd_major.fst")
parlament_election_2019_by_vd <- fst::read_fst("data/parlament_election_2019_by_vd.fst")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
ff <- parlament_election_2019_by_vd_major %>% mutate(
    Показник = Показник %>% stringr::str_replace_all("\\(1977\\)", "")
  ) %>% 
                  left_join(
                    parlament_election_2019_major_info %>% 
                      mutate(
                        `Прізвище, ім’я, по батькові кандидата в депутати` = 
                          stringr::str_replace_all(`Прізвище, ім’я, по батькові кандидата в депутати`, " ", "")
                      ) %>% 
                      select(`Прізвище, ім’я, по батькові кандидата в депутати`, Округ, Висування) %>% 
                      filter(Висування == "ПОЛІТИЧНА ПАРТІЯ \"СЛУГА НАРОДУ\""), 
                    by = c("Показник" = "Прізвище, ім’я, по батькові кандидата в депутати", "Округ")
                  ) %>% 
                  group_by(Округ) %>% 
                  summarise(
                    Слуга = sum(as.numeric(Кількість)[Висування == "ПОЛІТИЧНА ПАРТІЯ \"СЛУГА НАРОДУ\""], na.rm = T)
                  ) %>% left_join(
                    parlament_election_2019_by_vd_major %>% 
                      group_by(Округ) %>% 
                      summarise(
                        Кількість = sum(as.numeric(Кількість)[Показник == "14) Сумарна к-сть голосів виборців ЗА"])
                      ), by = "Округ"
                  ) %>% 
                  mutate(
                    Слуга = Слуга/Кількість
                  ) %>% 
                  left_join(
                    parlament_election_2019_by_vd %>% 
                      left_join(coord_dil %>% select(okrug, PEC), by = c("№ ВД" = "PEC")) %>% 
                      group_by(okrug) %>% 
                      summarise(
                        `ПОЛІТИЧНА ПАРТІЯ "СЛУГА НАРОДУ"` = sum(`ПОЛІТИЧНА ПАРТІЯ "СЛУГА НАРОДУ"`)/sum(`14) Сумарна к-сть голосів виборців ЗА`)
                      ), by = c("Округ" = "okrug")) %>% 
                  mutate(
                    dif = `ПОЛІТИЧНА ПАРТІЯ "СЛУГА НАРОДУ"` - Слуга
                  )
```

На цих парламентських виборах вперше в історії України одна з партій перемогла в більшості округів. При цьому по справжньому "сильних" мажоритарників у "Слуги народу" було мало, але партійний бренд був настільки популярний, що свої округи взяли навіть весільні фотографи, вчительки, тамада та інші не відомі широкому загалу особистості, перемігши більш іменитих суперників.

Однак, як це не дивно, не на всіх округах популярність партії перетікала у підтримку мажоритарного кандидата. Так, в середньому мажоритарний кандидат від "Слуги народу" отримував десь на 10-11% менше голосів, ніж партія на окрузі, однак в більшості випадків цього було достатньо для перемоги. Тільки на 15 округах з 199 мадоритарник від "Слуги народу" отримав більше, ніж партія на окрузі. При цьому 5 таких округів знаходяться в Харкові, а 3 - в Києві (можливо, у великих містах були більші можливості швидко "розрекламувати" саме персоналії, а не тільки партійний бренд).

```{r, echo=FALSE, message=FALSE, dpi=500, fig.height=5, fig.width=6, warning=FALSE}
ggplot(ovk %>% left_join(ff, by = c("No_okryg" = "Округ")) %>% 
         mutate(No_okryg = #ifelse(No_okryg %in% c(211:223, 115:118, 133:136, 24:28, 168:174), NA, No_okryg))
                  ifelse(dif > 0.258, No_okryg, NA))
       ) +
  geom_sf(aes(fill=dif), size = 0.1) +
  geom_sf_text(aes(label = No_okryg), size = 3) +
  coord_sf(datum=NA) +
  scale_fill_gradient2(
    low = "#1a9850", high = "#d73027", mid = "white",
    guide = guide_legend(
      nrow = 1,
      label.position = "bottom",
      title.position = "top",
      title = "% різниці"
    ),
    breaks = c(-0.1, -0.5, 0, 0.5, 0.1, 0.15, 0.2, 0.25, 0.3),
    labels = c(-0.1, -0.5, 0, 0.5, 0.1, 0.15, 0.2, 0.25, 0.3) * 100
  ) +
  labs(
    title = "Різниця в результаті голосування за партію Слуга народу і мажоритарника від неї",
    caption = "На основі даних ЦВК"
  ) +
  theme_ipsum(base_family = "PT Sans") +
  theme(
    panel.grid = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    legend.position = "bottom"
  ) 
```

Але були й округи, де "Слуга народу" не отримало свого мажоритарника навіть попри підтримку партії в 40+%. На карті вище відмічено 10 окргугів, де різниця між підтримкою партії на окрузі і підтримкою мажоритарника від "Слуги народу" була найбільшою (більше 25%). Переможці в цих окргугах зробили майже неможливе, те, що не вдалося навіть таким досвідченим мажоритарникам, як Володимир Литвин чи Сергій Ківалов.

Хто ці люди?

```{r, echo=FALSE, message=FALSE}
ff %>% arrange(desc(dif)) %>% rename(
  `Результат мажоритарника від Слуги народу` = Слуга,
  `Результат партії Слуга народу` = `ПОЛІТИЧНА ПАРТІЯ "СЛУГА НАРОДУ"`,
  `Різниця в результаті партії і мажоритарника` = dif
) %>% 
  slice(1:10) %>%
  mutate(
    `Переможець округу` = c("Поляк Владіслав Миколайович (самовисування)", 
                            "Петьовка Василь Васильович (самовисування)",
                            "Яценко Антон Володимирович (самовисування)",
                            "Шпенов Дмитро Юрійович (самовисування)",
                            "Молоток Ігор Федорович (самовисування)",
                            "Шаповалов Юрій Анатолійович (самовисування)",
                            "Коровченко Сергій Володимирович (самовисування)",
                            "Рудик Сергій Ярославович (самовисування)",
                            "Лунченко Валерій Валерійович (самовисування)",
                            'Бабенко Микола Вікторович (Політична Партія "Біла Церква разом")'),
    `#` = 1:10
  ) %>% 
  select(`#`, `Переможець округу`, Округ, `Результат мажоритарника від Слуги народу`, 
         `Результат партії Слуга народу`, `Різниця в результаті партії і мажоритарника`) %>% 
  gt() %>% 
  text_transform(
    locations = cells_data(vars(`#`)),
    fn = function(x) {
    list(web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15310.jpg",
      height = 50
    ), 
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15416.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15330.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15136.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=17299.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15333.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=17189.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15386.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=17065.jpg",
      height = 50
    ),
    web_image(
      url = "https://www.cvk.gov.ua/pls/vnd2019/showcandimgpt001f01=919pf7201=15353.jpg",
      height = 50
    )
    )}) %>% 
  fmt_percent(
    columns = vars(`Результат мажоритарника від Слуги народу`, 
                   `Результат партії Слуга народу`, 
                   `Різниця в результаті партії і мажоритарника`),
    decimals = 2,
    drop_trailing_zeros = TRUE
  ) %>% 
  data_color(
    columns = vars(`Результат мажоритарника від Слуги народу`, 
                   `Результат партії Слуга народу`, 
                   `Різниця в результаті партії і мажоритарника`),
    colors = scales::col_numeric(
      palette = c(
        "#ffffcc", "#800026"),
      domain = c(0, 1))
  ) %>% 
  tab_header(
    title = md("Топ-10 мажоритарників, які перемогли в округах попри сильну підтримку партії Слуга народу")
  ) %>% 
  tab_style(
    style = cells_styles(bkgd_color = "white"), locations = cells_data(
      columns = vars(`#`,`Переможець округу`, Округ))) %>%
  tab_source_note(
    source_note = "За даними сайту ЦВК (без врахування спецдільниць)"
  )
```

Відмітимо в першу чергу регіональну особливість. Троє з учасників топу - мажоритарники із Закарпаття. При цьому тільки один із цих трьох (Василь Петьовка) є частиною клану Балог, які стабільно обираються в Раду з округів Закарпаття. Владіслав Поляк, що є лідером нашого рейтингу, взагалі вперше обриається до Верховної ради. До цього він був тільки депутатом Виноградівської міської ради від Партії регіонів та депутатом Закарпатської обласної ради від Відродження. Третій представник Закарпаття у цьому списку Лунченко Валерій був депутатом парламенту попереднього скликання від Народного фронту, до цього був депутатом від Батьківщини. Висування як безпартійний самовисуванець та тривалий досвід роботи в Закарпатті (був депутатом Хустської міськради, Закарпатської облради та головою Закарпатської ОДА) допомогли йому перемогти на окрузі.

У нашому топі є два мажоритарники з Черкащини. Антон Яценко виграв 200 округ дуже впевнено (тільки три кандидати виграли свої округи з підтримкою більше 60%, Яценко - один із них). Це не перша його перемога в цьому окрузі, у попереднє скликання він пройшов по ньому ж. Цьому не завадила його неоднозначна політична біографія, яка включає в себе його неодноразові переходи між різними політичними силами. В останньому скликанні він був членом депутатської групи "Відродження". Сергій Рудик, який переміг по 198 округу, теж не відрізняється політичною відданістю, бо на минулих виборах переміг у цьому окрузі як член ВО "Свобода", але в 2015 вийшов з неї і потім приєднався до Блоку Петра Порошенка. Його перевага над кандидатом від "Слуги народу" склала близько 1000 голосів, при цьому "клон" відібрав у першого 1300.

Шпенов Дмитро - мажоритарник, який виграв округ, де у "Слуги народу" підтримка більше 60%! Виграв, щоправда, не без використання двійників проти основного конкурента (за даними ОПОРИ, таких на окрузі проти справжнього кандидата від "Слуги народу" було використано цілих 5! + одна з осіб, яка висувалася, мала таке саме прізвище, сумарно ці всі особи зібрали близько 10000 голосів). Хоч і балотувався він як самовисуванець, але у 8 скликанні він був членом Опоблоку, до того ж, ще раніше був помічений у якості помічника Олександра Вілкула та члена Партії регіонів. В окрузі перемагає третій раз підряд.

Ігор Молоток з 160 округу на Сумщині теж третій раз раз перемогає на своєму окрузі. Завжди обирався як безпартійний самовисуванець, але потім вступав, то в Партію регіонів, то у Волю народу. 

Юрій Шаповалов - ще один щасливчик, який скористався "клонами" кандидата від Слуги народу (таких на окрузі було 4). Сумарно ці кандидати відібрали у головного конкурента близько 3000 голосів - якраз рівно стільки не вистачило кандидату від "Слуги народу" для перемоги. В іншому біографія Шаповалова ідентична до біографії Ігора Молотка - 3-чі обраний за тим самим округом як безпартійний висуванець. Був членом Партії регіонів, Волі народу та Відродження.

А от для Сергія Коровченка перемога на окрузі перша в житті. Висувався як самовисуванець, однак є члеом партії "Батьківщина". Його перемога теж стала можливою через наявність у "Слуга народу" клонів. Два клони відібрали в кандидата від уже партії-влади близько 4500 голосів. З цими голосами округ мав би іншого переможця.

Єдиний висуванець від партії у цьому списку - мажоритарник від "Біла церква разом" Микола Бабенко. Певні життєві обставини змусили його відмовитись від асоціації із тими політичиними брендами, під якими він обирався в парламент попередні два рази - УДАР та Блок Петра Порошенка (можливо, те, що він з ними не зміг виграти округ). Така ставка на білоцеркіський патріотизм виявилася успішною і в окрузі він виграв без використання послуг двійників "Слуги народу".

Як бачимо, перемогти в окрузі дуже потужний партійний бренд можливо по суті тільки двома способами: дуже давно працювати в окрузі і стати "своїм" для його жителів (і при цьому не набриднути), або ж "знищити" свого конкурента за допомогою його клонів. Але і ці способи дають результат тільки проти маловідомих висуванців, бо, наприклад, Ігорю Кононенко проти Олександра Дубінського це все не допомогло.
